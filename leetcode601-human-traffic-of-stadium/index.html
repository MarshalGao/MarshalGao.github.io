<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="Marshal ">
<meta name="description" content="Question Table: Stadium
&#43;---------------&#43;---------&#43; | Column Name | Type | &#43;---------------&#43;---------&#43; | id | int | | visit_date | date | | people | int | &#43;---------------&#43;---------&#43; visit_date is the primary key for this table. Each row of this table contains the visit date and visit id to the stadium with the number of people during the visit. No two rows will have the same visit_date, and as the id increases, the dates increase as well." />
<meta name="keywords" content=", leetcode&#34;, #601, hard, sql, advertising product manager, human traffic of stadium" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="#252627" />
<link rel="canonical" href="https://www.marshalgao.com/leetcode601-human-traffic-of-stadium/" />


    <title>
        
            LeetCode[601] Human Traffic of Stadium :: This is Marshal 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://www.marshalgao.com/main.1abfe30dec5ae0f5c4f84acd6413b12f63e4a6f9e1e7167f42de12192bfd25e9.css">




    <link rel="apple-touch-icon" sizes="180x180" href="https://www.marshalgao.com/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://www.marshalgao.com/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://www.marshalgao.com/favicon-16x16.png">
    <link rel="manifest" href="https://www.marshalgao.com/site.webmanifest">
    <link rel="mask-icon" href="https://www.marshalgao.com/safari-pinned-tab.svg" color="#252627">
    <link rel="shortcut icon" href="https://www.marshalgao.com/favicon.ico">
    <meta name="msapplication-TileColor" content="#252627">
    <meta name="theme-color" content="#252627">



<meta itemprop="name" content="LeetCode[601] Human Traffic of Stadium">
<meta itemprop="description" content="Question Table: Stadium
&#43;---------------&#43;---------&#43; | Column Name | Type | &#43;---------------&#43;---------&#43; | id | int | | visit_date | date | | people | int | &#43;---------------&#43;---------&#43; visit_date is the primary key for this table. Each row of this table contains the visit date and visit id to the stadium with the number of people during the visit. No two rows will have the same visit_date, and as the id increases, the dates increase as well.">
<meta itemprop="datePublished" content="2021-01-14T13:31:17+08:00" />
<meta itemprop="dateModified" content="2021-01-14T13:31:17+08:00" />
<meta itemprop="wordCount" content="573">
<meta itemprop="image" content="https://www.marshalgao.com/"/>



<meta itemprop="keywords" content="leetcode&#34;,#601,hard,sql,advertising product manager,human traffic of stadium," />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://www.marshalgao.com/"/>

<meta name="twitter:title" content="LeetCode[601] Human Traffic of Stadium"/>
<meta name="twitter:description" content="Question Table: Stadium
&#43;---------------&#43;---------&#43; | Column Name | Type | &#43;---------------&#43;---------&#43; | id | int | | visit_date | date | | people | int | &#43;---------------&#43;---------&#43; visit_date is the primary key for this table. Each row of this table contains the visit date and visit id to the stadium with the number of people during the visit. No two rows will have the same visit_date, and as the id increases, the dates increase as well."/>



    <meta property="og:title" content="LeetCode[601] Human Traffic of Stadium" />
<meta property="og:description" content="Question Table: Stadium
&#43;---------------&#43;---------&#43; | Column Name | Type | &#43;---------------&#43;---------&#43; | id | int | | visit_date | date | | people | int | &#43;---------------&#43;---------&#43; visit_date is the primary key for this table. Each row of this table contains the visit date and visit id to the stadium with the number of people during the visit. No two rows will have the same visit_date, and as the id increases, the dates increase as well." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.marshalgao.com/leetcode601-human-traffic-of-stadium/" />
<meta property="og:image" content="https://www.marshalgao.com/"/>
<meta property="article:published_time" content="2021-01-14T13:31:17+08:00" />
<meta property="article:modified_time" content="2021-01-14T13:31:17+08:00" />




    <meta property="article:section" content="Technology" />



    <meta property="article:published_time" content="2021-01-14 13:31:17 &#43;0800 HKT" />









    </head>

    <body class="">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://www.marshalgao.com/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">$ cd /home/</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://www.marshalgao.com/categories/hku">HKU</a></li><li><a href="https://www.marshalgao.com/categories/technology">TECH</a></li><li><a href="https://www.marshalgao.com/categories/product-manager">PM</a></li><li><a href="https://www.marshalgao.com/categories/life">LIFE</a></li><li><a href="https://www.marshalgao.com/about/">ABOUT</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>

            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        3 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="https://www.marshalgao.com/leetcode601-human-traffic-of-stadium/">LeetCode[601] Human Traffic of Stadium</a>
      </h1>

      

      <div class="post-content">
        <h2 id="question">Question</h2>
<p>Table: Stadium</p>
<pre><code>+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| id            | int     |
| visit_date    | date    |
| people        | int     |
+---------------+---------+
visit_date is the primary key for this table.
Each row of this table contains the visit date and visit id to the stadium with the number of people during the visit.
No two rows will have the same visit_date, and as the id increases, the dates increase as well.
</code></pre>
<p>Write an SQL query to display the records with three or more rows with <strong>consecutive</strong> id&rsquo;s, and the number of people is greater than or equal to 100 for each.</p>
<p>Return the result table ordered by visit_date in <strong>ascending order</strong>.</p>
<p>The query result format is in the following example.</p>
<pre><code>Stadium table:
+------+------------+-----------+
| id   | visit_date | people    |
+------+------------+-----------+
| 1    | 2017-01-01 | 10        |
| 2    | 2017-01-02 | 109       |
| 3    | 2017-01-03 | 150       |
| 4    | 2017-01-04 | 99        |
| 5    | 2017-01-05 | 145       |
| 6    | 2017-01-06 | 1455      |
| 7    | 2017-01-07 | 199       |
| 8    | 2017-01-09 | 188       |
+------+------------+-----------+

Result table:
+------+------------+-----------+
| id   | visit_date | people    |   
+------+------------+-----------+
| 5    | 2017-01-05 | 145       |
| 6    | 2017-01-06 | 1455      |
| 7    | 2017-01-07 | 199       |
| 8    | 2017-01-09 | 188       |
+------+------------+-----------+
The four rows with ids 5, 6, 7, and 8 have consecutive ids and each of them has &gt;= 100 people attended. Note that row 8 was included even though the visit_date was not the next day after row 7.
The rows with ids 2 and 3 are not included because we need at least three consecutive ids.
</code></pre>
<h2 id="sql-schema">SQL Schema</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">Create</span> <span style="color:#66d9ef">table</span> <span style="color:#66d9ef">If</span> <span style="color:#66d9ef">Not</span> <span style="color:#66d9ef">Exists</span> stadium (id int, visit_date DATE <span style="color:#66d9ef">NULL</span>, people int)
<span style="color:#66d9ef">Truncate</span> <span style="color:#66d9ef">table</span> stadium
<span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> stadium (id, visit_date, people) <span style="color:#66d9ef">values</span> (<span style="color:#e6db74">&#39;1&#39;</span>, <span style="color:#e6db74">&#39;2017-01-01&#39;</span>, <span style="color:#e6db74">&#39;10&#39;</span>)
<span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> stadium (id, visit_date, people) <span style="color:#66d9ef">values</span> (<span style="color:#e6db74">&#39;2&#39;</span>, <span style="color:#e6db74">&#39;2017-01-02&#39;</span>, <span style="color:#e6db74">&#39;109&#39;</span>)
<span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> stadium (id, visit_date, people) <span style="color:#66d9ef">values</span> (<span style="color:#e6db74">&#39;3&#39;</span>, <span style="color:#e6db74">&#39;2017-01-03&#39;</span>, <span style="color:#e6db74">&#39;150&#39;</span>)
<span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> stadium (id, visit_date, people) <span style="color:#66d9ef">values</span> (<span style="color:#e6db74">&#39;4&#39;</span>, <span style="color:#e6db74">&#39;2017-01-04&#39;</span>, <span style="color:#e6db74">&#39;99&#39;</span>)
<span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> stadium (id, visit_date, people) <span style="color:#66d9ef">values</span> (<span style="color:#e6db74">&#39;5&#39;</span>, <span style="color:#e6db74">&#39;2017-01-05&#39;</span>, <span style="color:#e6db74">&#39;145&#39;</span>)
<span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> stadium (id, visit_date, people) <span style="color:#66d9ef">values</span> (<span style="color:#e6db74">&#39;6&#39;</span>, <span style="color:#e6db74">&#39;2017-01-06&#39;</span>, <span style="color:#e6db74">&#39;1455&#39;</span>)
<span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> stadium (id, visit_date, people) <span style="color:#66d9ef">values</span> (<span style="color:#e6db74">&#39;7&#39;</span>, <span style="color:#e6db74">&#39;2017-01-07&#39;</span>, <span style="color:#e6db74">&#39;199&#39;</span>)
<span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> stadium (id, visit_date, people) <span style="color:#66d9ef">values</span> (<span style="color:#e6db74">&#39;8&#39;</span>, <span style="color:#e6db74">&#39;2017-01-09&#39;</span>, <span style="color:#e6db74">&#39;188&#39;</span>)
</code></pre></div><h2 id="my-interesting-code">My Interesting Code</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">with</span> temp <span style="color:#66d9ef">as</span> (
    <span style="color:#66d9ef">select</span> id, visit_date, people
    <span style="color:#66d9ef">from</span> (
        <span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span>,
            lag(id) over(<span style="color:#66d9ef">order</span> <span style="color:#66d9ef">by</span> visit_date) <span style="color:#66d9ef">as</span> preId,
            lead(id) over(<span style="color:#66d9ef">order</span> <span style="color:#66d9ef">by</span> visit_date) <span style="color:#66d9ef">as</span> nextId
        <span style="color:#66d9ef">from</span> Stadium
        <span style="color:#66d9ef">where</span> people <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">100</span>
    ) temp1
    <span style="color:#66d9ef">where</span> id <span style="color:#f92672">=</span> preId <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> <span style="color:#66d9ef">and</span> id <span style="color:#f92672">=</span> nextId <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>
)

<span style="color:#66d9ef">select</span> Stadium.id, Stadium.visit_date, Stadium.people
<span style="color:#66d9ef">from</span> Stadium, temp
<span style="color:#66d9ef">where</span> Stadium.id <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">=</span> temp.id <span style="color:#66d9ef">or</span> Stadium.id <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">=</span> temp.id
<span style="color:#66d9ef">union</span>
<span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span>
<span style="color:#66d9ef">from</span> temp
<span style="color:#66d9ef">order</span> <span style="color:#66d9ef">by</span>(id)
</code></pre></div><h2 id="my-perspective">My Perspective</h2>
<p>This question is not difficult but complex. Firstly, you can find consecutive &ldquo;ids&rdquo;, which the people&rsquo;s numbers are larger than or equal to 100 for each. In this question, I use &ldquo;with&hellip;as&hellip;&rdquo; to make this table become a variable called &ldquo;temp&rdquo;, which can be used in all the selections. Then, find the first and the last elements, combining the &ldquo;temp&rdquo;. More importantly, you should use &ldquo;union&rdquo; to connect two tables and use &ldquo;order by()&rdquo; to satisfy the demand of this question.</p>
<p>Also, there are four useful links, and I think they can help you. (chinese version)</p>
<ul>
<li><a href="https://www.cnblogs.com/beautifuldata/p/3204294.html">useful link 1</a></li>
<li><a href="https://blog.csdn.net/weixin_41600552/article/details/82958942">useful link 2</a></li>
<li><a href="https://www.w3school.com.cn/sql/sql_union.asp">useful link 3</a></li>
<li><a href="https://www.cnblogs.com/kakaisgood/p/11102704.html">useful link 4</a></li>
</ul>

      </div>
    </article>

    <hr />

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://www.marshalgao.com/tags/leetcode/">leetcode&#34;</a></span>
        <span class="tag"><a href="https://www.marshalgao.com/tags/#601/">#601</a></span>
        <span class="tag"><a href="https://www.marshalgao.com/tags/hard/">hard</a></span>
        <span class="tag"><a href="https://www.marshalgao.com/tags/sql/">sql</a></span>
        <span class="tag"><a href="https://www.marshalgao.com/tags/advertising-product-manager/">advertising product manager</a></span>
        <span class="tag"><a href="https://www.marshalgao.com/tags/human-traffic-of-stadium/">human traffic of stadium</a></span>
        
    </p>

      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="https://www.marshalgao.com/categories/technology/">Technology</a></span>
        
    </p>


      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        573 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          2021-01-14 13:31
        

         
          
        
      </p>
    </div>

    
      <div class="pagination">
        <div class="pagination__title">
          <span class="pagination__title-h"></span>
          <hr />
        </div>

        <div class="pagination__buttons">
          
            <span class="button previous">
              <a href="https://www.marshalgao.com/leetcode620-not-boring-movies/">
                <span class="button__icon">←</span>
                <span class="button__text">LeetCode[620] Not Boring Movies</span>
              </a>
            </span>
          

          
            <span class="button next">
              <a href="https://www.marshalgao.com/ecom7123-smart-environment-and-energy/">
                <span class="button__text">ECOM7123 Smart Environment and Energy</span>
                <span class="button__icon">→</span>
              </a>
            </span>
          
        </div>
      </div>
    


    

  </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span><a href="https://www.hku.hk" target="_blank" rel="noopener">The University of Hong Kong</a></span>
            <span><a href="https://www.ecom-icom.hku.hk" target="_blank" rel="noopener">ECIC</a></span>
          </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2020-2021</span>
            
                
                <span>Marshal</a></span>
            
            
            
        </div>
    </div>
</footer>


            
        </div>

        




<script type="text/javascript" src="https://www.marshalgao.com/bundle.min.dc716e9092c9820b77f96da294d0120aeeb189b5bcea9752309ebea27fd53bbe6b13cffb2aca8ecf32525647ceb7001f76091de4199ac5a3caa432c070247f5b.js" integrity="sha512-3HFukJLJggt3&#43;W2ilNASCu6xibW86pdSMJ6&#43;on/VO75rE8/7KsqOzzJSVkfOtwAfdgkd5BmaxaPKpDLAcCR/Ww=="></script>



    </body>
</html>
