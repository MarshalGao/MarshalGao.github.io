<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="Marshal ">
<meta name="description" content="Question The Employee table holds all employees. Every employee has an Id, a salary, and there is also a column for the department Id.
&#43;----&#43;-------&#43;--------&#43;--------------&#43; | Id | Name | Salary | DepartmentId | &#43;----&#43;-------&#43;--------&#43;--------------&#43; | 1 | Joe | 70000 | 1 | | 2 | Jim | 90000 | 1 | | 3 | Henry | 80000 | 2 | | 4 | Sam | 60000 | 2 | | 5 | Max | 90000 | 1 | &#43;----&#43;-------&#43;--------&#43;--------------&#43;  The Department table holds all departments of the company." />
<meta name="keywords" content=", leetcode, #184, medium, sql, advertising product manager, department highest salary" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="#252627" />
<link rel="canonical" href="https://www.marshalgao.com/leetcode184-department-highest-salary/" />


    <title>
        
            LeetCode[184] Department Highest Salary :: This Is Marshal 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://www.marshalgao.com/main.1abfe30dec5ae0f5c4f84acd6413b12f63e4a6f9e1e7167f42de12192bfd25e9.css">




    <link rel="apple-touch-icon" sizes="180x180" href="https://www.marshalgao.com/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://www.marshalgao.com/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://www.marshalgao.com/favicon-16x16.png">
    <link rel="manifest" href="https://www.marshalgao.com/site.webmanifest">
    <link rel="mask-icon" href="https://www.marshalgao.com/safari-pinned-tab.svg" color="#252627">
    <link rel="shortcut icon" href="https://www.marshalgao.com/favicon.ico">
    <meta name="msapplication-TileColor" content="#252627">
    <meta name="theme-color" content="#252627">



<meta itemprop="name" content="LeetCode[184] Department Highest Salary">
<meta itemprop="description" content="Question The Employee table holds all employees. Every employee has an Id, a salary, and there is also a column for the department Id.
&#43;----&#43;-------&#43;--------&#43;--------------&#43; | Id | Name | Salary | DepartmentId | &#43;----&#43;-------&#43;--------&#43;--------------&#43; | 1 | Joe | 70000 | 1 | | 2 | Jim | 90000 | 1 | | 3 | Henry | 80000 | 2 | | 4 | Sam | 60000 | 2 | | 5 | Max | 90000 | 1 | &#43;----&#43;-------&#43;--------&#43;--------------&#43;  The Department table holds all departments of the company.">
<meta itemprop="datePublished" content="2021-01-12T11:37:06+08:00" />
<meta itemprop="dateModified" content="2021-01-12T11:37:06+08:00" />
<meta itemprop="wordCount" content="494">
<meta itemprop="image" content="https://www.marshalgao.com/"/>



<meta itemprop="keywords" content="leetcode,#184,medium,sql,advertising product manager,department highest salary," />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://www.marshalgao.com/"/>

<meta name="twitter:title" content="LeetCode[184] Department Highest Salary"/>
<meta name="twitter:description" content="Question The Employee table holds all employees. Every employee has an Id, a salary, and there is also a column for the department Id.
&#43;----&#43;-------&#43;--------&#43;--------------&#43; | Id | Name | Salary | DepartmentId | &#43;----&#43;-------&#43;--------&#43;--------------&#43; | 1 | Joe | 70000 | 1 | | 2 | Jim | 90000 | 1 | | 3 | Henry | 80000 | 2 | | 4 | Sam | 60000 | 2 | | 5 | Max | 90000 | 1 | &#43;----&#43;-------&#43;--------&#43;--------------&#43;  The Department table holds all departments of the company."/>



    <meta property="og:title" content="LeetCode[184] Department Highest Salary" />
<meta property="og:description" content="Question The Employee table holds all employees. Every employee has an Id, a salary, and there is also a column for the department Id.
&#43;----&#43;-------&#43;--------&#43;--------------&#43; | Id | Name | Salary | DepartmentId | &#43;----&#43;-------&#43;--------&#43;--------------&#43; | 1 | Joe | 70000 | 1 | | 2 | Jim | 90000 | 1 | | 3 | Henry | 80000 | 2 | | 4 | Sam | 60000 | 2 | | 5 | Max | 90000 | 1 | &#43;----&#43;-------&#43;--------&#43;--------------&#43;  The Department table holds all departments of the company." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.marshalgao.com/leetcode184-department-highest-salary/" />
<meta property="og:image" content="https://www.marshalgao.com/"/>
<meta property="article:published_time" content="2021-01-12T11:37:06+08:00" />
<meta property="article:modified_time" content="2021-01-12T11:37:06+08:00" />




    <meta property="article:section" content="Technology" />



    <meta property="article:published_time" content="2021-01-12 11:37:06 &#43;0800 HKT" />









    </head>

    <body class="">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://www.marshalgao.com/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">$ cd /home/</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://www.marshalgao.com/categories/hku">HKU</a></li><li><a href="https://www.marshalgao.com/categories/technology">TECH</a></li><li><a href="https://www.marshalgao.com/categories/product-manager">PM</a></li><li><a href="https://www.marshalgao.com/categories/life">LIFE</a></li><li><a href="https://www.marshalgao.com/about/">ABOUT</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>

            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        3 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="https://www.marshalgao.com/leetcode184-department-highest-salary/">LeetCode[184] Department Highest Salary</a>
      </h1>

      

      <div class="post-content">
        <h2 id="question">Question</h2>
<p>The Employee table holds all employees. Every employee has an Id, a salary, and there is also a column for the department Id.</p>
<pre><code>+----+-------+--------+--------------+
| Id | Name  | Salary | DepartmentId |
+----+-------+--------+--------------+
| 1  | Joe   | 70000  | 1            |
| 2  | Jim   | 90000  | 1            |
| 3  | Henry | 80000  | 2            |
| 4  | Sam   | 60000  | 2            |
| 5  | Max   | 90000  | 1            |
+----+-------+--------+--------------+
</code></pre>
<p>The Department table holds all departments of the company.</p>
<pre><code>+----+----------+
| Id | Name     |
+----+----------+
| 1  | IT       |
| 2  | Sales    |
+----+----------+
</code></pre>
<p>Write a SQL query to find employees who have the highest salary in each of the departments. For the above tables, your SQL query should return the following rows (order of rows does not matter).</p>
<pre><code>+------------+----------+--------+
| Department | Employee | Salary |
+------------+----------+--------+
| IT         | Max      | 90000  |
| IT         | Jim      | 90000  |
| Sales      | Henry    | 80000  |
+------------+----------+--------+
</code></pre>
<p><strong>Explanation</strong>:</p>
<p>Max and Jim both have the highest salary in the IT department and Henry has the highest salary in the Sales department.</p>
<h2 id="sql-schema">SQL Schema</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">Create</span> <span style="color:#66d9ef">table</span> <span style="color:#66d9ef">If</span> <span style="color:#66d9ef">Not</span> <span style="color:#66d9ef">Exists</span> Employee (Id int, Name varchar(<span style="color:#ae81ff">255</span>), Salary int, DepartmentId int)
<span style="color:#66d9ef">Create</span> <span style="color:#66d9ef">table</span> <span style="color:#66d9ef">If</span> <span style="color:#66d9ef">Not</span> <span style="color:#66d9ef">Exists</span> Department (Id int, Name varchar(<span style="color:#ae81ff">255</span>))
<span style="color:#66d9ef">Truncate</span> <span style="color:#66d9ef">table</span> Employee
<span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> Employee (Id, Name, Salary, DepartmentId) <span style="color:#66d9ef">values</span> (<span style="color:#e6db74">&#39;1&#39;</span>, <span style="color:#e6db74">&#39;Joe&#39;</span>, <span style="color:#e6db74">&#39;70000&#39;</span>, <span style="color:#e6db74">&#39;1&#39;</span>)
<span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> Employee (Id, Name, Salary, DepartmentId) <span style="color:#66d9ef">values</span> (<span style="color:#e6db74">&#39;2&#39;</span>, <span style="color:#e6db74">&#39;Jim&#39;</span>, <span style="color:#e6db74">&#39;90000&#39;</span>, <span style="color:#e6db74">&#39;1&#39;</span>)
<span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> Employee (Id, Name, Salary, DepartmentId) <span style="color:#66d9ef">values</span> (<span style="color:#e6db74">&#39;3&#39;</span>, <span style="color:#e6db74">&#39;Henry&#39;</span>, <span style="color:#e6db74">&#39;80000&#39;</span>, <span style="color:#e6db74">&#39;2&#39;</span>)
<span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> Employee (Id, Name, Salary, DepartmentId) <span style="color:#66d9ef">values</span> (<span style="color:#e6db74">&#39;4&#39;</span>, <span style="color:#e6db74">&#39;Sam&#39;</span>, <span style="color:#e6db74">&#39;60000&#39;</span>, <span style="color:#e6db74">&#39;2&#39;</span>)
<span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> Employee (Id, Name, Salary, DepartmentId) <span style="color:#66d9ef">values</span> (<span style="color:#e6db74">&#39;5&#39;</span>, <span style="color:#e6db74">&#39;Max&#39;</span>, <span style="color:#e6db74">&#39;90000&#39;</span>, <span style="color:#e6db74">&#39;1&#39;</span>)
<span style="color:#66d9ef">Truncate</span> <span style="color:#66d9ef">table</span> Department
<span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> Department (Id, Name) <span style="color:#66d9ef">values</span> (<span style="color:#e6db74">&#39;1&#39;</span>, <span style="color:#e6db74">&#39;IT&#39;</span>)
<span style="color:#66d9ef">insert</span> <span style="color:#66d9ef">into</span> Department (Id, Name) <span style="color:#66d9ef">values</span> (<span style="color:#e6db74">&#39;2&#39;</span>, <span style="color:#e6db74">&#39;Sales&#39;</span>)
</code></pre></div><h2 id="my-interesting-code">My Interesting Code</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">select</span> temp1.Department, temp1.Employee, temp1.Salary
<span style="color:#66d9ef">from</span> (
    <span style="color:#66d9ef">select</span> Employee.Name <span style="color:#66d9ef">as</span> Employee, Employee.Salary, Employee.DepartmentId, Department.Name <span style="color:#66d9ef">as</span> Department
    <span style="color:#66d9ef">from</span> Employee
    <span style="color:#66d9ef">inner</span> <span style="color:#66d9ef">join</span> Department <span style="color:#66d9ef">on</span> Employee.DepartmentId <span style="color:#f92672">=</span> Department.Id
) temp1,
    (<span style="color:#66d9ef">select</span> <span style="color:#66d9ef">max</span>(Salary) <span style="color:#66d9ef">as</span> Salary, DepartmentId
    <span style="color:#66d9ef">from</span> Employee
    <span style="color:#66d9ef">group</span> <span style="color:#66d9ef">by</span> DepartmentId) temp2
<span style="color:#66d9ef">where</span> temp1.DepartmentId <span style="color:#f92672">=</span> temp2.DepartmentId <span style="color:#66d9ef">and</span> temp1.Salary <span style="color:#f92672">=</span> temp2.Salary
</code></pre></div><h2 id="my-perspective">My Perspective</h2>
<p>This question is a little bit complex, but I think there would be other better solutions. Firstly, you can find all the highest salary of different departments. Then, you can just use this table - &ldquo;temp2&rdquo;- to find relevant people. Because different people meay have the same salary, you need to do the second step, finding all the relevant people.</p>
<p>However, when I submitted for the first time, I failed. Becasue according to the question, if an employee does not belong to any department, the result would be null, even if the employee&rsquo;s salary is extremely high. Therefore, the &ldquo;join&rdquo; should use &ldquo;inner join&rdquo; rather than &ldquo;left join&rdquo;. &ldquo;Inner join&rdquo; would only return the compared successfully ones, others would be set null.</p>
<p>Also, there is a useful link, and I think it can help you. (chinese version)</p>
<ul>
<li><a href="https://www.cnblogs.com/wgphp/p/8183812.html">useful link</a></li>
</ul>

      </div>
    </article>

    <hr />

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://www.marshalgao.com/tags/leetcode/">leetcode</a></span>
        <span class="tag"><a href="https://www.marshalgao.com/tags/#184/">#184</a></span>
        <span class="tag"><a href="https://www.marshalgao.com/tags/medium/">medium</a></span>
        <span class="tag"><a href="https://www.marshalgao.com/tags/sql/">sql</a></span>
        <span class="tag"><a href="https://www.marshalgao.com/tags/advertising-product-manager/">advertising product manager</a></span>
        <span class="tag"><a href="https://www.marshalgao.com/tags/department-highest-salary/">department highest salary</a></span>
        
    </p>

      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="https://www.marshalgao.com/categories/technology/">Technology</a></span>
        
    </p>


      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        494 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          2021-01-12 11:37
        

         
          
        
      </p>
    </div>

    
      <div class="pagination">
        <div class="pagination__title">
          <span class="pagination__title-h"></span>
          <hr />
        </div>

        <div class="pagination__buttons">
          
            <span class="button previous">
              <a href="https://www.marshalgao.com/leetcode185-department-top-three-salaries/">
                <span class="button__icon">←</span>
                <span class="button__text">LeetCode[185] Department Top Three Salaries</span>
              </a>
            </span>
          

          
            <span class="button next">
              <a href="https://www.marshalgao.com/leetcode183-customers-who-never-order/">
                <span class="button__text">LeetCode[183] Customers Who Never Order</span>
                <span class="button__icon">→</span>
              </a>
            </span>
          
        </div>
      </div>
    


    

  </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2020-2021</span>
            
                <span><a href="https://www.marshalgao.com/">Marshal</a></span>
            
            
                <span><a href="https://www.hku.hk" target="_blank" rel="noopener">The University of Hong Kong</a></span>
            <span><a href="https://www.marshalgao.com/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Team Rocket: <a href="https://www.pseudoyu.com/" target="_blank" rel="noopener">Pseudoyu</a></span>
            <span><a href="https://www.m1sty.com/" target="_blank" rel="noopener">Misty</a></span>
          </div>
    </div>
</footer>


            
        </div>

        




<script type="text/javascript" src="https://www.marshalgao.com/bundle.min.dc716e9092c9820b77f96da294d0120aeeb189b5bcea9752309ebea27fd53bbe6b13cffb2aca8ecf32525647ceb7001f76091de4199ac5a3caa432c070247f5b.js" integrity="sha512-3HFukJLJggt3&#43;W2ilNASCu6xibW86pdSMJ6&#43;on/VO75rE8/7KsqOzzJSVkfOtwAfdgkd5BmaxaPKpDLAcCR/Ww=="></script>



    </body>
</html>
